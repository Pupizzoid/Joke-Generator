!function(){const e="https://api.chucknorris.io/jokes/random",t="https://api.chucknorris.io/jokes/categories";let r=function(){const e=localStorage.getItem("jokes");if(e)return JSON.parse(e);return[]}(),n=[];function o(e){return fetch(e).then(e=>e.json())}function c(e,t){let r=(e.getTime()-t.getTime())/1e3;return r/=3600,Math.abs(Math.round(r))}function a(e,t=null,r=null,n=null,o=null){const c=document.createElement(e);if(Array.isArray(t))for(let e of t)c.classList.add(e);else t&&c.classList.add(t);if(Array.isArray(r))for(let e of r)if("string"==typeof e){const t=document.createTextNode(e);c.appendChild(t)}else e&&c.appendChild(e);else if(r)if("string"==typeof r)if("input"===e)c.value=r;else{const e=document.createTextNode(r);c.appendChild(e)}else c.appendChild(r);if(n)for(let e in n)n.hasOwnProperty(e)&&c.setAttribute(e,n[e]);if(o)for(let e in o)o.hasOwnProperty(e)&&c.addEventListener(e,o[e]);return c}function i(e){return a("div","joke",[a("span","joke__icon"),a("div","joke__content",[a("p","joke__id",[a("span","joke__id-text","ID: "),a("a","joke__link",[e.id],{href:e.url})]),a("p","joke__description",e.value),a("span","joke__data-update",`Last updated: ${c(new Date,new Date(e.updated_at))} hours ago`),0!==e.categories.length?a("span","joke__category",e.categories):null]),a("button",d(e)?["joke__save","active"]:"joke__save",null,null,{click:function(t){!function(e){if(d(e)){for(let t=0;t<r.length;t++)if(r[t].id===e.id){r.splice(t,1);break}}else r.push(e);localStorage.removeItem("jokes"),localStorage.setItem("jokes",JSON.stringify(r)),l(),u()}(e)}})])}function s(e){return e.map(e=>i(e))}function l(){const e=document.querySelector("#favorite");e.innerHTML="",e.append(...s(r))}function u(){const e=document.querySelector("#root");e.innerHTML="",0===n.length&&e.appendChild(a("div",null,"Sorry, we don't have any jokes by your request")),e.append(...s(n))}function d(e){return!!r.find(t=>t.id===e.id)}function f(){return o(e)}function p(e){return o("https://api.chucknorris.io/jokes/random?category="+e.category)}function h(e){const t=document.querySelector(".form__search-field"),r=document.querySelector("#search_error");return e.search.length>=3?(r.innerHTML="",t.value="",o("https://api.chucknorris.io/jokes/search?query="+e.search.toLowerCase())):(t.value="",r.innerText="Your request should contain at least 3 letters",null)}o(t).then(e=>{}).catch(e=>[]),window.addEventListener("DOMContentLoaded",(function(){l();document.getElementsByName("choice").forEach(r=>{r.addEventListener("change",(function(){const r=document.querySelector(".categories-list"),n=document.querySelector(".form__search-field");r&&r.remove(),n&&n.remove(),"categories"===this.value&&(e=p,o(t).then(e=>{var t;document.querySelector(".form__item--category").appendChild(a("div","form__categories-list")).append(...(t=e,t.map(e=>a("label","form__category",[a("input","form__field-category",null,{type:"radio",name:"category",value:e},{change:e=>{document.querySelectorAll(".form__category").forEach(e=>{e.classList.remove("active")}),e.target.parentElement.classList.add("active")}}),e]))))})),"random"===this.value&&(e=f),"search"===this.value&&(e=h,document.querySelector(".form__item--search").append(a("input","form__search-field",null,{placeholder:"Free text search...",type:"search",name:"search",required:""}),a("span","form__search-error",null,{id:"search_error"})))}))});let e=f;document.querySelector("#submit").addEventListener("click",(function(t){t.preventDefault();const r=document.querySelector("#form"),o=Object.fromEntries(Array.from(new FormData(r))),c=e(o);null!==c&&c.then(e=>{n=e.result?e.result:[e],u()})}));const r=document.querySelector(".favorite-block"),c=document.querySelector("#btn_open"),i=document.querySelector("#btn_close");c.addEventListener("click",(function(){r.classList.add("active")})),i.addEventListener("click",(function(){r.classList.remove("active")}))}))}();